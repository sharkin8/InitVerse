package systemcontract

import (
	"github.com/ethereum/go-ethereum/common"
	"github.com/ethereum/go-ethereum/core"
	"github.com/ethereum/go-ethereum/core/state"
	"github.com/ethereum/go-ethereum/core/types"
	"github.com/ethereum/go-ethereum/log"
	"github.com/ethereum/go-ethereum/params"
	"math/big"
)

var (
	validatorV1Admin        = common.HexToAddress("0xce930537a2148b8dc43899ff2e9bcbee0e801c54")
	validatorV1AdminTestnet = common.HexToAddress("0xce930537a2148b8dc43899ff2e9bcbee0e801c54")
)

const (
	validatorV1Code = "0x608060405260043610620002285760003560e01c80639001eed81162000134578063c885bc5811620000be578063ec0cb3361162000089578063f40f0f52116200006c578063f40f0f5214620005bc578063f851a44014620005ed578063fc6c1f02146200061457600080fd5b8063ec0cb33614620002f9578063f3b1cc6714620002f957600080fd5b8063c885bc581462000535578063c967f90f146200054d578063d6c0edad1462000578578063d86768e9146200058257600080fd5b8063bb8b65af11620000ff578063bb8b65af146200049d578063bc4a703e14620004b5578063bcecf81b14620004dc578063c36f8c91146200050157600080fd5b80639001eed814620004375780639cc02c3014620004565780639de70258146200046d578063afeea115146200048557600080fd5b80633eee042611620001b65780636846992a11620001815780636846992a14620003bd57806371a1bb7514620003e257806371df767814620003fa5780638f283970146200041257600080fd5b80633eee0426146200032857806344f999001462000340578063462d0b2e146200037157806360544bf1146200039657600080fd5b806315de360e11620001f757806315de360e14620002bd5780631c0ffaa214620002d45780632e4f67e414620002f95780633bd07e34146200031057600080fd5b806303fab4f6146200022d57806306661abd146200025e578063136ec0b31462000276578063158ef93e1462000290575b600080fd5b3480156200023a57600080fd5b506200024b670de0b6b3a764000081565b6040519081526020015b60405180910390f35b3480156200026b57600080fd5b506200024b60015481565b3480156200028357600080fd5b506200028e62000639565b005b3480156200029d57600080fd5b50600054620002ac9060ff1681565b604051901515815260200162000255565b348015620002ca57600080fd5b506200024b600a81565b348015620002e157600080fd5b506200028e620002f336600462003566565b62000811565b3480156200030657600080fd5b506200024b601481565b3480156200031d57600080fd5b506200024b60025481565b3480156200033557600080fd5b506200024b60085481565b3480156200034d57600080fd5b506200035861c00381565b6040516001600160a01b03909116815260200162000255565b3480156200037e57600080fd5b506200028e62000390366004620035d7565b62000946565b348015620003a357600080fd5b50620003ae62000c4c565b60405162000255919062003772565b348015620003ca57600080fd5b506200028e620003dc36600462003624565b62000cb0565b348015620003ef57600080fd5b506200035861c00281565b3480156200040757600080fd5b506200028e620010e8565b3480156200041f57600080fd5b506200028e620004313660046200351f565b620011eb565b3480156200044457600080fd5b506200024b6802b5e3af16b188000081565b3480156200046357600080fd5b506006546200024b565b3480156200047a57600080fd5b50620003ae62001300565b3480156200049257600080fd5b50620003ae62001362565b348015620004aa57600080fd5b506200028e62001528565b348015620004c257600080fd5b50620004cd620016f7565b604051620002559190620037c1565b348015620004e957600080fd5b5062000358620004fb366004620036fa565b6200196a565b3480156200050e57600080fd5b5062000526620005203660046200351f565b62001995565b60405162000255919062003828565b3480156200054257600080fd5b506200028e62001fd4565b3480156200055a57600080fd5b5062000564600f81565b60405161ffff909116815260200162000255565b6200028e6200204c565b3480156200058f57600080fd5b5062000358620005a13660046200351f565b6007602052600090815260409020546001600160a01b031681565b348015620005c957600080fd5b506200024b620005db3660046200351f565b60096020526000908152604090205481565b348015620005fa57600080fd5b50600054620003589061010090046001600160a01b031681565b3480156200062157600080fd5b506200035862000633366004620035a8565b62002653565b6000339050806001600160a01b031660076000836001600160a01b0316633a5381b56040518163ffffffff1660e01b815260040160206040518083038186803b1580156200068657600080fd5b505afa1580156200069b573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190620006c1919062003546565b6001600160a01b0390811682526020820192909252604001600020541614620007315760405162461bcd60e51b815260206004820152601860248201527f566f746520706f6f6c206e6f742072656769737465726564000000000000000060448201526064015b60405180910390fd5b336001816001600160a01b031663c19d93fb6040518163ffffffff1660e01b815260040160206040518083038186803b1580156200076e57600080fd5b505afa15801562000783573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190620007a991906200366d565b6003811115620007bd57620007bd620039d1565b14620007fe5760405162461bcd60e51b815260206004820152600f60248201526e496e636f727265637420737461746560881b604482015260640162000728565b600b6200080c8183620027a4565b505050565b60005461010090046001600160a01b031633146200085f5760405162461bcd60e51b815260206004820152600a60248201526927b7363c9030b236b4b760b11b604482015260640162000728565b6001600160a01b0382811660009081526007602052604090205416620008d25760405162461bcd60e51b815260206004820152602160248201527f436f72726573706f6e64696e6720766f746520706f6f6c206e6f7420666f756e6044820152601960fa1b606482015260840162000728565b6001600160a01b0382811660009081526007602052604090819020549051638ec7a23d60e01b81528315156004820152911690638ec7a23d90602401600060405180830381600087803b1580156200092957600080fd5b505af11580156200093e573d6000803e3d6000fd5b505050505050565b60005460ff16156200099b5760405162461bcd60e51b815260206004820152601360248201527f416c726561647920696e697469616c697a656400000000000000000000000000604482015260640162000728565b6000825111620009ee5760405162461bcd60e51b815260206004820152600e60248201527f496e76616c696420706172616d73000000000000000000000000000000000000604482015260640162000728565b6001600160a01b03811662000a465760405162461bcd60e51b815260206004820152601560248201527f496e76616c69642061646d696e20616464726573730000000000000000000000604482015260640162000728565b6000805460017fffffffffffffffffffffff0000000000000000000000000000000000000000009091166101006001600160a01b038516021781178255600f905560028190555b82518160ff1610156200080c576000838260ff168151811062000ab45762000ab4620039e7565b6020908102919091018101516001600160a01b0380821660009081526007909352604090922054909250161562000b2e5760405162461bcd60e51b815260206004820152601960248201527f56616c696461746f727320616c72656164792065786973747300000000000000604482015260640162000728565b60008162000b40600a612710620038c0565b600160405162000b5090620033b7565b62000b5e939291906200372e565b604051809103906000f08015801562000b7b573d6000803e3d6000fd5b5060068054600181019091557ff652222313e28459528d920b65115c16c04f3efc82aaedc97be59f3f377c0d3f0180546001600160a01b038086166001600160a01b031992831681179093556000928352600760205260408084208054928616929093168217909255815163204a7f0760e21b8152915193945092638129fc1c9260048084019391929182900301818387803b15801562000c1b57600080fd5b505af115801562000c30573d6000803e3d6000fd5b505050505050808062000c43906200396b565b91505062000a8d565b6060600480548060200260200160405190810160405280929190818152602001828054801562000ca657602002820191906000526020600020905b81546001600160a01b0316815260019091019060200180831162000c87575b5050505050905090565b33411462000d015760405162461bcd60e51b815260206004820152600a60248201527f4d696e6572206f6e6c7900000000000000000000000000000000000000000000604482015260640162000728565b8062000d0e81436200398e565b1562000d5d5760405162461bcd60e51b815260206004820152601060248201527f426c6f636b2065706f6368206f6e6c7900000000000000000000000000000000604482015260640162000728565b436000908152600a60209081526040808320600180855292529091205460ff161562000dbf5760405162461bcd60e51b815260206004820152601060248201526f105b1c9958591e481bdc195c985d195960821b604482015260640162000728565b60005460ff1662000e025760405162461bcd60e51b815260206004820152600c60248201526b139bdd081a5b9a5d081e595d60a21b604482015260640162000728565b436000908152600a60209081526040808320600180855292528220805460ff191690911790555b60035481101562000e9c576000600560006003848154811062000e505762000e50620039e7565b6000918252602080832091909101546001600160a01b031683528201929092526040019020805460ff191660ff929092169190911790558062000e93816200394d565b91505062000e29565b50835162000eb2906003906020870190620033c5565b5060005b60035481101562000f29576001600560006003848154811062000edd5762000edd620039e7565b6000918252602080832091909101546001600160a01b031683528201929092526040019020805460ff191660ff929092169190911790558062000f20816200394d565b91505062000eb6565b5062000f38600460006200342f565b600254600b80546001600160a01b03165b60008311801562000f6257506001600160a01b03811615155b15620010df5760056000826001600160a01b0316633a5381b56040518163ffffffff1660e01b815260040160206040518083038186803b15801562000fa657600080fd5b505afa15801562000fbb573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019062000fe1919062003546565b6001600160a01b0316815260208101919091526040016000205460ff16620010bc576004816001600160a01b0316633a5381b56040518163ffffffff1660e01b815260040160206040518083038186803b1580156200103f57600080fd5b505afa15801562001054573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906200107a919062003546565b81546001810183556000928352602090922090910180546001600160a01b0319166001600160a01b0390921691909117905582620010b88162003913565b9350505b6001600160a01b0390811660009081526003830160205260409020541662000f49565b50505050505050565b6000339050806001600160a01b031660076000836001600160a01b0316633a5381b56040518163ffffffff1660e01b815260040160206040518083038186803b1580156200113557600080fd5b505afa1580156200114a573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019062001170919062003546565b6001600160a01b0390811682526020820192909252604001600020541614620011dc5760405162461bcd60e51b815260206004820152601860248201527f566f746520706f6f6c206e6f7420726567697374657265640000000000000000604482015260640162000728565b33600b6200080c818362002db9565b806001600160a01b038116620012445760405162461bcd60e51b815260206004820152600f60248201527f496e76616c696420616464726573730000000000000000000000000000000000604482015260640162000728565b60005461010090046001600160a01b03163314620012925760405162461bcd60e51b815260206004820152600a60248201526927b7363c9030b236b4b760b11b604482015260640162000728565b600080547fffffffffffffffffffffff0000000000000000000000000000000000000000ff166101006001600160a01b03858116820292909217808455604051919004909116917f927cc064d7b7fa546fa7706bc01845d27d06f15af3ae90a672cc44735928e96191a25050565b6060600380548060200260200160405190810160405280929190818152602001828054801562000ca6576020028201919060005260206000209081546001600160a01b0316815260019091019060200180831162000c87575050505050905090565b600154600c54606091600091600b91600160a01b90910460ff161015620013a65760018101546200139e90600160a01b900460ff1683620038a5565b9150620013b8565b600154620013b59083620038a5565b91505b60008267ffffffffffffffff811115620013d657620013d6620039fd565b60405190808252806020026020018201604052801562001400578160200160208202803683370190505b5060015483549192506000916001600160a01b03165b6000821180156200142f57506001600160a01b03811615155b156200151d57806001600160a01b0316633a5381b56040518163ffffffff1660e01b815260040160206040518083038186803b1580156200146f57600080fd5b505afa15801562001484573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190620014aa919062003546565b848481518110620014bf57620014bf620039e7565b6001600160a01b039092166020928302919091019091015282620014e3816200394d565b9350508180620014f39062003913565b6001600160a01b039283166000908152600388016020526040902054909350909116905062001416565b509195945050505050565b6000339050806001600160a01b031660076000836001600160a01b0316633a5381b56040518163ffffffff1660e01b815260040160206040518083038186803b1580156200157557600080fd5b505afa1580156200158a573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190620015b0919062003546565b6001600160a01b03908116825260208201929092526040016000205416146200161c5760405162461bcd60e51b815260206004820152601860248201527f566f746520706f6f6c206e6f7420726567697374657265640000000000000000604482015260640162000728565b336001816001600160a01b031663c19d93fb6040518163ffffffff1660e01b815260040160206040518083038186803b1580156200165957600080fd5b505afa1580156200166e573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906200169491906200366d565b6003811115620016a857620016a8620039d1565b14620016e95760405162461bcd60e51b815260206004820152600f60248201526e496e636f727265637420737461746560881b604482015260640162000728565b600b6200080c818362002fc0565b60065460609060008167ffffffffffffffff8111156200171b576200171b620039fd565b6040519080825280602002602001820160405280156200176857816020015b60408051606081018252600080825260208083018290529282015282526000199092019101816200173a5790505b50905060005b828110156200196357600681815481106200178d576200178d620039e7565b9060005260206000200160009054906101000a90046001600160a01b0316828281518110620017c057620017c0620039e7565b6020026020010151600001906001600160a01b031690816001600160a01b03168152505060076000838381518110620017fd57620017fd620039e7565b6020026020010151600001516001600160a01b03166001600160a01b0316815260200190815260200160002060009054906101000a90046001600160a01b0316828281518110620018525762001852620039e7565b6020026020010151602001906001600160a01b031690816001600160a01b0316815250506007600060068381548110620018905762001890620039e7565b60009182526020808320909101546001600160a01b03908116845283820194909452604092830190912054825163f1cea4c760e01b8152925193169263f1cea4c7926004808201939291829003018186803b158015620018ef57600080fd5b505afa15801562001904573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906200192a919062003714565b8282815181106200193f576200193f620039e7565b602090810291909101015160400152806200195a816200394d565b9150506200176e565b5092915050565b600681815481106200197b57600080fd5b6000918252602090912001546001600160a01b0316905081565b60606000805b60065481101562001a8e5760006007600060068481548110620019c257620019c2620039e7565b6000918252602080832091909101546001600160a01b0390811684529083019390935260409182019020549051639ed1f25560e01b81528783166004820152911690639ed1f2559060240160806040518083038186803b15801562001a2657600080fd5b505afa15801562001a3b573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019062001a61919062003690565b51111562001a795762001a76826001620038a5565b91505b8062001a85816200394d565b9150506200199b565b5060008167ffffffffffffffff81111562001aad5762001aad620039fd565b60405190808252806020026020018201604052801562001b0f57816020015b6040805160c08101825260008082526020808301829052928201819052606082018190526080820181905260a0820152825260001990920191018162001acc5790505b5090506000805b60065481101562001fca576000600760006006848154811062001b3d5762001b3d620039e7565b6000918252602080832091909101546001600160a01b0390811684529083019390935260409182019020549051639ed1f25560e01b81528983166004820152911690639ed1f2559060240160806040518083038186803b15801562001ba157600080fd5b505afa15801562001bb6573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019062001bdc919062003690565b51111562001fb5576006818154811062001bfa5762001bfa620039e7565b9060005260206000200160009054906101000a90046001600160a01b031683838151811062001c2d5762001c2d620039e7565b6020026020010151600001906001600160a01b031690816001600160a01b031681525050600760006006838154811062001c6b5762001c6b620039e7565b60009182526020808320909101546001600160a01b039081168452908301939093526040909101902054845191169084908490811062001caf5762001caf620039e7565b6020026020010151602001906001600160a01b031690816001600160a01b031681525050600760006006838154811062001ced5762001ced620039e7565b60009182526020808320909101546001600160a01b03908116845283820194909452604092830190912054825163f1cea4c760e01b8152925193169263f1cea4c7926004808201939291829003018186803b15801562001d4c57600080fd5b505afa15801562001d61573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019062001d87919062003714565b83838151811062001d9c5762001d9c620039e7565b602002602001015160400181815250508583838151811062001dc25762001dc2620039e7565b6020026020010151606001906001600160a01b031690816001600160a01b031681525050600760006006838154811062001e005762001e00620039e7565b6000918252602080832091909101546001600160a01b03908116845290830193909352604091820190205490516326fceb5d60e11b81528883166004820152911690634df9d6ba9060240160206040518083038186803b15801562001e6457600080fd5b505afa15801562001e79573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019062001e9f919062003714565b83838151811062001eb45762001eb4620039e7565b602002602001015160a0018181525050600760006006838154811062001ede5762001ede620039e7565b6000918252602080832091909101546001600160a01b0390811684529083019390935260409182019020549051639ed1f25560e01b81528883166004820152911690639ed1f2559060240160806040518083038186803b15801562001f4257600080fd5b505afa15801562001f57573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019062001f7d919062003690565b6000015183838151811062001f965762001f96620039e7565b60209081029190910101516080015262001fb2826001620038a5565b91505b8062001fc1816200394d565b91505062001b16565b5090949350505050565b336000908152600960205260409020548062001fed5750565b3360008181526009602052604080822082905580517fff3d9e4f000000000000000000000000000000000000000000000000000000008152905163ff3d9e4f9285926004808201939182900301818588803b1580156200092957600080fd5b436000908152600a6020908152604080832083805290915281205460ff1615620020ac5760405162461bcd60e51b815260206004820152601060248201526f105b1c9958591e481bdc195c985d195960821b604482015260640162000728565b60005460ff16620020ef5760405162461bcd60e51b815260206004820152600c60248201526b139bdd081a5b9a5d081e595d60a21b604482015260640162000728565b436000908152600a602090815260408083208380529091528120805460ff19166001179055600854620021239034620038a5565b90506000606462002136600a84620038d7565b620021429190620038c0565b90506000606462002155602885620038d7565b620021619190620038c0565b90506000606462002174603286620038d7565b620021809190620038c0565b60045490915015620023d2576000805b60045460ff8216101562002278576007600060048360ff1681548110620021bb57620021bb620039e7565b60009182526020808320909101546001600160a01b03908116845283820194909452604092830190912054825163f1cea4c760e01b8152925193169263f1cea4c7926004808201939291829003018186803b1580156200221a57600080fd5b505afa1580156200222f573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019062002255919062003714565b620022619083620038a5565b9150806200226f816200396b565b91505062002190565b508015620023d05760005b60045460ff82161015620023ce5760006007600060048460ff1681548110620022b057620022b0620039e7565b60009182526020808320909101546001600160a01b039081168452838201949094526040928301822054835163f1cea4c760e01b815293519416945090928692859263f1cea4c792600480840193829003018186803b1580156200231357600080fd5b505afa15801562002328573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906200234e919062003714565b6200235a9089620038d7565b620023669190620038c0565b6001600160a01b0383166000908152600960205260409020549091506200238f908290620038a5565b6001600160a01b038316600090815260096020526040902055620023b48189620038f9565b975050508080620023c5906200396b565b91505062002283565b505b505b600354156200264a576000805b60035460ff82161015620024c7576007600060038360ff16815481106200240a576200240a620039e7565b60009182526020808320909101546001600160a01b03908116845283820194909452604092830190912054825163f1cea4c760e01b8152925193169263f1cea4c7926004808201939291829003018186803b1580156200246957600080fd5b505afa1580156200247e573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190620024a4919062003714565b620024b09083620038a5565b915080620024be816200396b565b915050620023df565b5060005b60035460ff82161015620026475760006007600060038460ff1681548110620024f857620024f8620039e7565b60009182526020808320909101546001600160a01b0390811684529083019390935260409091018120546003549216925090620025369086620038c0565b90508315620025e25760008487846001600160a01b031663f1cea4c76040518163ffffffff1660e01b815260040160206040518083038186803b1580156200257d57600080fd5b505afa15801562002592573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190620025b8919062003714565b620025c49190620038d7565b620025d09190620038c0565b9050620025de8183620038a5565b9150505b6001600160a01b03821660009081526009602052604090205462002608908290620038a5565b6001600160a01b0383166000908152600960205260409020556200262d8189620038f9565b9750505080806200263e906200396b565b915050620024cb565b50505b50505060085550565b6001600160a01b0382811660009081526007602052604081205490911615620026bf5760405162461bcd60e51b815260206004820152601960248201527f56616c696461746f727320616c72656164792065786973747300000000000000604482015260640162000728565b600083836000604051620026d390620033b7565b620026e1939291906200372e565b604051809103906000f080158015620026fe573d6000803e3d6000fd5b5060068054600181019091557ff652222313e28459528d920b65115c16c04f3efc82aaedc97be59f3f377c0d3f0180546001600160a01b03199081166001600160a01b038881169182179093556000818152600760209081526040918290208054909416948616948517909355519283529293507f1ab57f2e2a6e4069160cc6501d8012d93ed435770b1ed646f82482a2f7234ff4910160405180910390a29392505050565b6001820154600160a01b900460ff16620028175781546001600160a01b0382166001600160a01b0319918216811784556001840180549092161780825560ff600160a01b90910416906014620027fa836200396b565b91906101000a81548160ff021916908360ff160217905550505050565b81546001600160a01b038281169116141562002831575050565b6001600160a01b038082166000908152600284016020526040902054168062002a0557600183018054600160a01b900460ff1690601462002872836200396b565b91906101000a81548160ff021916908360ff160217905550508260010160009054906101000a90046001600160a01b03166001600160a01b031663f1cea4c76040518163ffffffff1660e01b815260040160206040518083038186803b158015620028dc57600080fd5b505afa158015620028f1573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019062002917919062003714565b826001600160a01b031663f1cea4c76040518163ffffffff1660e01b815260040160206040518083038186803b1580156200295157600080fd5b505afa15801562002966573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906200298c919062003714565b11620029f057506001820180546001600160a01b039283166000818152600286016020908152604080832080549588166001600160a01b03199687161790558554909616825260039096019095529290932080548416831790558054909216179055565b5060018201546001600160a01b031662002bad565b806001600160a01b031663f1cea4c76040518163ffffffff1660e01b815260040160206040518083038186803b15801562002a3f57600080fd5b505afa15801562002a54573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019062002a7a919062003714565b826001600160a01b031663f1cea4c76040518163ffffffff1660e01b815260040160206040518083038186803b15801562002ab457600080fd5b505afa15801562002ac9573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019062002aef919062003714565b1162002afa57505050565b6001600160a01b038083166000818152600386016020526040808220548585168352912080546001600160a01b0319169184169190911790556001850154909116141562002b65576001830180546001600160a01b0319166001600160a01b03831617905562002bad565b6001600160a01b03808316600090815260028501602081815260408084205460038901835281852054861685529290915290912080546001600160a01b031916919092161790555b6001600160a01b0381161580159062002cad5750806001600160a01b031663f1cea4c76040518163ffffffff1660e01b815260040160206040518083038186803b15801562002bfb57600080fd5b505afa15801562002c10573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019062002c36919062003714565b826001600160a01b031663f1cea4c76040518163ffffffff1660e01b815260040160206040518083038186803b15801562002c7057600080fd5b505afa15801562002c85573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019062002cab919062003714565b115b1562002cd6576001600160a01b0390811660009081526002840160205260409020541662002bad565b6001600160a01b03811662002d47575081546001600160a01b039182166000818152600385016020908152604080832080549587166001600160a01b031996871617905586549095168252600286019052838120805484168317905581815292909220805482169055825416179055565b6001600160a01b0390811660008181526003850160209081526040808320805496861680855282852080549888166001600160a01b0319998a16179055815490961684526002909701909152808220805486168517905585548516841790955591825292902080549091169091179055565b81546001600160a01b0382811691161480159062002df157506001600160a01b03818116600090815260028401602052604090205416155b1562002dfb575050565b60018201546001600160a01b038281169116141562002e48576001600160a01b0380821660009081526002840160205260409020546001840180546001600160a01b031916919092161790555b81546001600160a01b038281169116141562002e8c576001600160a01b03808216600090815260038401602052604090205483546001600160a01b03191691161782555b6001600160a01b03808216600090815260038401602052604090205416801562002ee8576001600160a01b038083166000908152600285016020526040808220548484168352912080546001600160a01b031916919092161790555b6001600160a01b03808316600090815260028501602052604090205416801562002f44576001600160a01b038084166000908152600386016020526040808220548484168352912080546001600160a01b031916919092161790555b6001600160a01b0383166000908152600285016020908152604080832080546001600160a01b03199081169091556003880190925290912080549091169055600184018054600160a01b900460ff1690601462002fa1836200392d565b91906101000a81548160ff021916908360ff1602179055505050505050565b6001600160a01b03808216600081815260038501602052604090205460018501549083169216148062002ffa57506001600160a01b038116155b80620030ee5750816001600160a01b031663f1cea4c76040518163ffffffff1660e01b815260040160206040518083038186803b1580156200303b57600080fd5b505afa15801562003050573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019062003076919062003714565b816001600160a01b031663f1cea4c76040518163ffffffff1660e01b815260040160206040518083038186803b158015620030b057600080fd5b505afa158015620030c5573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190620030eb919062003714565b11155b15620030f957505050565b6001600160a01b038083166000818152600286016020526040808220548585168352912080546001600160a01b031916918416919091179055845490911614156200315d5782546001600160a01b0319166001600160a01b0382161783556200319f565b6001600160a01b0382811660009081526002850160209081526040808320548416835260038701909152902080546001600160a01b0319169183169190911790555b6001600160a01b038116158015906200329f5750816001600160a01b031663f1cea4c76040518163ffffffff1660e01b815260040160206040518083038186803b158015620031ed57600080fd5b505afa15801562003202573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019062003228919062003714565b816001600160a01b031663f1cea4c76040518163ffffffff1660e01b815260040160206040518083038186803b1580156200326257600080fd5b505afa15801562003277573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906200329d919062003714565b115b15620032c8576001600160a01b039081166000908152600384016020526040902054166200319f565b6001600160a01b0381166200333f57506001820180546001600160a01b039283166000818152600286016020908152604080832080549588166001600160a01b0319968716179055600390970190528581208054841690558354909416845293909220805483168417905580549091169091179055565b6001600160a01b0390811660008181526002850160208181526040808420805487168552600390980180835281852080546001600160a01b0319908116998916998a17909155848452895489875283872080549190991690821617909755825283208054861685179055929091529052825416179055565b6125e78062003a2a83390190565b8280548282559060005260206000209081019282156200341d579160200282015b828111156200341d57825182546001600160a01b0319166001600160a01b03909116178255602090920191600190910190620033e6565b506200342b92915062003452565b5090565b50805460008255906000526020600020908101906200344f919062003452565b50565b5b808211156200342b576000815560010162003453565b600082601f8301126200347b57600080fd5b8135602067ffffffffffffffff808311156200349b576200349b620039fd565b8260051b604051601f19603f83011681018181108482111715620034c357620034c3620039fd565b60405284815283810192508684018288018501891015620034e357600080fd5b600092505b8583101562003513578035620034fe8162003a13565b845292840192600192909201918401620034e8565b50979650505050505050565b6000602082840312156200353257600080fd5b81356200353f8162003a13565b9392505050565b6000602082840312156200355957600080fd5b81516200353f8162003a13565b600080604083850312156200357a57600080fd5b8235620035878162003a13565b9150602083013580151581146200359d57600080fd5b809150509250929050565b60008060408385031215620035bc57600080fd5b8235620035c98162003a13565b946020939093013593505050565b60008060408385031215620035eb57600080fd5b823567ffffffffffffffff8111156200360357600080fd5b620036118582860162003469565b92505060208301356200359d8162003a13565b600080604083850312156200363857600080fd5b823567ffffffffffffffff8111156200365057600080fd5b6200365e8582860162003469565b95602094909401359450505050565b6000602082840312156200368057600080fd5b8151600481106200353f57600080fd5b600060808284031215620036a357600080fd5b6040516080810181811067ffffffffffffffff82111715620036c957620036c9620039fd565b8060405250825181526020830151602082015260408301516040820152606083015160608201528091505092915050565b6000602082840312156200370d57600080fd5b5035919050565b6000602082840312156200372757600080fd5b5051919050565b6001600160a01b03841681526020810183905260608101600483106200376457634e487b7160e01b600052602160045260246000fd5b826040830152949350505050565b6020808252825182820181905260009190848201906040850190845b81811015620037b55783516001600160a01b0316835292840192918401916001016200378e565b50909695505050505050565b602080825282518282018190526000919060409081850190868401855b828110156200381b57815180516001600160a01b0390811686528782015116878601528501518585015260609093019290850190600101620037de565b5091979650505050505050565b602080825282518282018190526000919060409081850190868401855b828110156200381b57815180516001600160a01b039081168652878201518116888701528682015187870152606080830151909116908601526080808201519086015260a0908101519085015260c0909301929085019060010162003845565b60008219821115620038bb57620038bb620039a5565b500190565b600082620038d257620038d2620039bb565b500490565b6000816000190483118215151615620038f457620038f4620039a5565b500290565b6000828210156200390e576200390e620039a5565b500390565b600081620039255762003925620039a5565b506000190190565b600060ff821680620039435762003943620039a5565b6000190192915050565b6000600019821415620039645762003964620039a5565b5060010190565b600060ff821660ff811415620039855762003985620039a5565b60010192915050565b600082620039a057620039a0620039bb565b500690565b634e487b7160e01b600052601160045260246000fd5b634e487b7160e01b600052601260045260246000fd5b634e487b7160e01b600052602160045260246000fd5b634e487b7160e01b600052603260045260246000fd5b634e487b7160e01b600052604160045260246000fd5b6001600160a01b03811681146200344f57600080fdfe60806040523480156200001157600080fd5b50604051620025e7380380620025e7833981016040819052620000349162000152565b60018055826001600160a01b038116620000875760405162461bcd60e51b815260206004820152600f60248201526e496e76616c6964206164647265737360881b60448201526064015b60405180910390fd5b82600a620000996127106003620001cb565b620000a59190620001a8565b811115620000e85760405162461bcd60e51b815260206004820152600f60248201526e125b9d985b1a59081c195c98d95b9d608a1b60448201526064016200007e565b60028054610100600160a81b031981166101006001600160a01b03891602908117835560048790558592916001600160a81b03191660ff199091161760018360038111156200013b576200013b620001f9565b0217905550506103e8600a55506200020f92505050565b6000806000606084860312156200016857600080fd5b83516001600160a01b03811681146200018057600080fd5b602085015160408601519194509250600481106200019d57600080fd5b809150509250925092565b600082620001c657634e487b7160e01b600052601260045260246000fd5b500490565b6000816000190483118215151615620001f457634e487b7160e01b600052601160045260246000fd5b500290565b634e487b7160e01b600052602160045260246000fd5b6123c8806200021f6000396000f3fe60806040526004361061026a5760003560e01c80638ec7a23d11610153578063ba26d9ff116100cb578063ec0cb3361161007f578063f1cea4c711610064578063f1cea4c71461065c578063f3b1cc6714610309578063ff3d9e4f1461067257600080fd5b8063ec0cb33614610309578063f06d5e771461063c57600080fd5b8063c967f90f116100b0578063c967f90f146105f7578063d0e30db01461061f578063e9fad8ee1461062757600080fd5b8063ba26d9ff146105bb578063c19d93fb146105d057600080fd5b806397a8ccd5116101225780639ed1f255116101075780639ed1f255146104f1578063a3ec138d14610544578063a6606679146105a657600080fd5b806397a8ccd5146104d45780639e83d5b1146104dc57600080fd5b80638ec7a23d1461046b5780638f76691a1461048b5780639001eed8146104a1578063939d6237146104be57600080fd5b806344f99900116101e657806370ba1113116101b557806372a11da41161019a57806372a11da4146104215780638129fc1c14610441578063826d3dec1461045657600080fd5b806370ba1113146103f557806371a1bb751461040b57600080fd5b806344f99900146103a2578063483a00e8146103b85780634df9d6ba146103c057806358fd41ea146103e057600080fd5b80632b8aba7a1161023d5780633a5381b5116102225780633a5381b51461031e5780633ccfd60b1461035b57806341f4ca621461037257600080fd5b80632b8aba7a146102f35780632e4f67e41461030957600080fd5b806303fab4f61461026f578063158ef93e1461029e57806315de360e146102c857806324c5b1ca146102dd575b600080fd5b34801561027b57600080fd5b5061028b670de0b6b3a764000081565b6040519081526020015b60405180910390f35b3480156102aa57600080fd5b506000546102b89060ff1681565b6040519015158152602001610295565b3480156102d457600080fd5b5061028b600a81565b3480156102e957600080fd5b5061028b600c5481565b3480156102ff57600080fd5b5061028b600b5481565b34801561031557600080fd5b5061028b601481565b34801561032a57600080fd5b506002546103439061010090046001600160a01b031681565b6040516001600160a01b039091168152602001610295565b34801561036757600080fd5b5061037061067a565b005b34801561037e57600080fd5b5060055460065461038d919082565b60408051928352602083019190915201610295565b3480156103ae57600080fd5b5061034361c00381565b61037061080d565b3480156103cc57600080fd5b5061028b6103db366004612273565b610ac8565b3480156103ec57600080fd5b5061028b610bf4565b34801561040157600080fd5b5061028b60045481565b34801561041757600080fd5b5061034361c00281565b34801561042d57600080fd5b5061037061043c3660046122c5565b610c9f565b34801561044d57600080fd5b50610370610fe4565b34801561046257600080fd5b506103706110e5565b34801561047757600080fd5b506103706104863660046122a3565b61127b565b34801561049757600080fd5b5061028b60035481565b3480156104ad57600080fd5b5061028b6802b5e3af16b188000081565b3480156104ca57600080fd5b5061028b60095481565b610370611455565b3480156104e857600080fd5b506103706115f1565b3480156104fd57600080fd5b5061051161050c366004612273565b6117ee565b60405161029591908151815260208083015190820152604080830151908201526060918201519181019190915260800190565b34801561055057600080fd5b5061058661055f366004612273565b60086020526000908152604090208054600182015460028301546003909301549192909184565b604080519485526020850193909352918301526060820152608001610295565b3480156105b257600080fd5b50610370611867565b3480156105c757600080fd5b506103706119c5565b3480156105dc57600080fd5b506002546105ea9060ff1681565b60405161029591906122f7565b34801561060357600080fd5b5061060c600f81565b60405161ffff9091168152602001610295565b610370611af7565b34801561063357600080fd5b50610370611da2565b34801561064857600080fd5b506103706106573660046122c5565b611f4b565b34801561066857600080fd5b5061028b600a5481565b610370612036565b600260015414156106d25760405162461bcd60e51b815260206004820152601f60248201527f5265656e7472616e637947756172643a207265656e7472616e742063616c6c0060448201526064015b60405180910390fd5b6002600155336000908152600860205260409020600301546014906106f79043612378565b116107445760405162461bcd60e51b815260206004820152601260248201527f496e74657276616c20746f6f20736d616c6c000000000000000000000000000060448201526064016106c9565b336000908152600860205260409020600201546107a35760405162461bcd60e51b815260206004820152601860248201527f56616c75652073686f756c64206e6f74206265207a65726f000000000000000060448201526064016106c9565b33600081815260086020526040812060028101805490839055600390910191909155906107d090826120fc565b60405181815233907f884edad9ce6fa2440d8a54cc123490eb96d2768479d49ff9c7366125a9424364906020015b60405180910390a25060018055565b60025461010090046001600160a01b031633146108655760405162461bcd60e51b815260206004820152601660248201527513db9b1e481d985b1a59185d1bdc88185b1b1bddd95960521b60448201526064016106c9565b61086d61221a565b6108ab5760405162461bcd60e51b815260206004820152600f60248201526e496e636f727265637420737461746560881b60448201526064016106c9565b600c5415806108c757506014600c54436108c59190612378565b115b6109135760405162461bcd60e51b815260206004820152601860248201527f496e74657276616c206e6f74206c6f6e6720656e6f756768000000000000000060448201526064016106c9565b600034116109635760405162461bcd60e51b815260206004820152601860248201527f56616c75652073686f756c64206e6f74206265207a65726f000000000000000060448201526064016106c9565b6000600c5560035461097690349061231f565b60035560405134815233907f278e696bd0cd4a7d1260ced26c40cd01c2b088f441889e4148240ac81069b3489060200160405180910390a26802b5e3af16b188000060035410610ac6576002805460ff1916600117908190556040516363e1d45160e01b81526101009091046001600160a01b0316600482015261c003906363e1d45190602401600060405180830381600087803b158015610a1757600080fd5b505af1158015610a2b573d6000803e3d6000fd5b5050505061c0026001600160a01b031663136ec0b36040518163ffffffff1660e01b8152600401600060405180830381600087803b158015610a6c57600080fd5b505af1158015610a80573d6000803e3d6000fd5b505060025460ff169150506003811115610a9c57610a9c6123a5565b6040517f402ee26d4c255fcb07b0b7b5b93b77377832260977c25be44f3c8feffd2df70e90600090a25b565b604051637a0787a960e11b8152306004820152600090819061c0029063f40f0f529060240160206040518083038186803b158015610b0557600080fd5b505afa158015610b19573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610b3d91906122de565b9050600061271060045483610b529190612359565b610b5c9190612337565b600954600a549192509015610ba457600a548190670de0b6b3a7640000610b838587612378565b610b8d9190612359565b610b979190612337565b610ba1919061231f565b90505b6001600160a01b038516600090815260086020526040902060018101549054670de0b6b3a764000090610bd79084612359565b610be19190612337565b610beb9190612378565b95945050505050565b604051637a0787a960e11b8152306004820152600090819061c0029063f40f0f529060240160206040518083038186803b158015610c3157600080fd5b505afa158015610c45573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610c6991906122de565b9050600061271060045483610c7e9190612359565b610c889190612337565b905080600754610c98919061231f565b9250505090565b60026001541415610cf25760405162461bcd60e51b815260206004820152601f60248201527f5265656e7472616e637947756172643a207265656e7472616e742063616c6c0060448201526064016106c9565b600260015580610d445760405162461bcd60e51b815260206004820152601860248201527f56616c75652073686f756c64206e6f74206265207a65726f000000000000000060448201526064016106c9565b33600090815260086020526040902054811115610da35760405162461bcd60e51b815260206004820152601360248201527f496e73756666696369656e7420616d6f756e740000000000000000000000000060448201526064016106c9565b61c0026001600160a01b031663c885bc586040518163ffffffff1660e01b8152600401600060405180830381600087803b158015610de057600080fd5b505af1158015610df4573d6000803e3d6000fd5b505033600090815260086020526040812060018101549054600954929450909250670de0b6b3a764000091610e299190612359565b610e339190612337565b610e3d9190612378565b905081600a54610e4d9190612378565b600a5533600090815260086020526040902054610e6b908390612378565b336000908152600860205260409020819055600954670de0b6b3a764000091610e949190612359565b610e9e9190612337565b33600090815260086020526040902060019081019190915560025460ff166003811115610ecd57610ecd6123a5565b1415610f295761c0026001600160a01b031663bb8b65af6040518163ffffffff1660e01b8152600401600060405180830381600087803b158015610f1057600080fd5b505af1158015610f24573d6000803e3d6000fd5b505050505b33600090815260086020526040902060020154610f4790839061231f565b336000818152600860205260409020600281019290925543600390920191909155610f7290826120fc565b60405182815233907f41b45db803eded5e27cdf3cbba5707b3575e9b6959de41c3f7b83b51ce6005029060200160405180910390a260405181815233907f7cddc560d4de1ea9d83e4123f01e6072afc503bb47bcc765f0396ba3861a04549060200160405180910390a2505060018055565b3361c002146110355760405162461bcd60e51b815260206004820152601860248201527f56616c696461746f727320636f6e7472616374206f6e6c79000000000000000060448201526064016106c9565b60005460ff16156110885760405162461bcd60e51b815260206004820152601360248201527f416c726561647920696e697469616c697a65640000000000000000000000000060448201526064016106c9565b6000805460ff191660011781556040805163136ec0b360e01b8152905161c0029263136ec0b3926004808201939182900301818387803b1580156110cb57600080fd5b505af11580156110df573d6000803e3d6000fd5b50505050565b3361c003146111365760405162461bcd60e51b815260206004820152601460248201527f50756e69736820636f6e7472616374206f6e6c7900000000000000000000000060448201526064016106c9565b43600b556002805460ff166003811115611152576111526123a5565b14611191576002805460ff191660039081179091556040517f402ee26d4c255fcb07b0b7b5b93b77377832260977c25be44f3c8feffd2df70e90600090a25b61c0026001600160a01b03166371df76786040518163ffffffff1660e01b8152600401600060405180830381600087803b1580156111ce57600080fd5b505af11580156111e2573d6000803e3d6000fd5b505050506000670de0b6b3a764000060035410156112025760035461120c565b670de0b6b3a76400005b9050801561127857806003546112229190612378565b6003556112306000826120fc565b6002546040518281526101009091046001600160a01b0316907febbcaaf6b9aa8b4083ae4b2f842c8de6f75319018e7b5e141a1e87aebadde6c3906020015b60405180910390a25b50565b3361c002146112cc5760405162461bcd60e51b815260206004820152601860248201527f56616c696461746f727320636f6e7472616374206f6e6c79000000000000000060448201526064016106c9565b80156113c6576112da61221a565b806112fb5750600160025460ff1660038111156112f9576112f96123a5565b145b6113395760405162461bcd60e51b815260206004820152600f60248201526e496e636f727265637420737461746560881b60448201526064016106c9565b6002805460ff1916811781556040517f402ee26d4c255fcb07b0b7b5b93b77377832260977c25be44f3c8feffd2df70e90600090a261c0026001600160a01b03166371df76786040518163ffffffff1660e01b8152600401600060405180830381600087803b1580156113ab57600080fd5b505af11580156113bf573d6000803e3d6000fd5b5050505050565b6002805460ff1660038111156113de576113de6123a5565b1461141d5760405162461bcd60e51b815260206004820152600f60248201526e496e636f727265637420737461746560881b60448201526064016106c9565b6002805460ff1916905560006040517f402ee26d4c255fcb07b0b7b5b93b77377832260977c25be44f3c8feffd2df70e90600090a250565b600260015414156114a85760405162461bcd60e51b815260206004820152601f60248201527f5265656e7472616e637947756172643a207265656e7472616e742063616c6c0060448201526064016106c9565b600260018190555461010090046001600160a01b031633146115055760405162461bcd60e51b815260206004820152601660248201527513db9b1e481d985b1a59185d1bdc88185b1b1bddd95960521b60448201526064016106c9565b61c0026001600160a01b031663c885bc586040518163ffffffff1660e01b8152600401600060405180830381600087803b15801561154257600080fd5b505af1158015611556573d6000803e3d6000fd5b505050506000600754116115ac5760405162461bcd60e51b815260206004820152600e60248201527f4e6f206d6f72652072657761726400000000000000000000000000000000000060448201526064016106c9565b6007805460009091556115bf33826120fc565b60405181815233907fe4fc75e2b70d2f179fc77c722f2334ba1507c59932576ec9620b15dfb06d91e2906020016107fe565b600260015414156116445760405162461bcd60e51b815260206004820152601f60248201527f5265656e7472616e637947756172643a207265656e7472616e742063616c6c0060448201526064016106c9565b600260018190555461010090046001600160a01b031633146116a15760405162461bcd60e51b815260206004820152601660248201527513db9b1e481d985b1a59185d1bdc88185b1b1bddd95960521b60448201526064016106c9565b6116a961221a565b6116e75760405162461bcd60e51b815260206004820152600f60248201526e496e636f727265637420737461746560881b60448201526064016106c9565b6000600c5411801561170657506014600c54436117049190612378565b115b6117525760405162461bcd60e51b815260206004820152601860248201527f496e74657276616c206e6f74206c6f6e6720656e6f756768000000000000000060448201526064016106c9565b6000600354116117a45760405162461bcd60e51b815260206004820152600e60248201527f4e6f206d6f7265206d617267696e00000000000000000000000000000000000060448201526064016106c9565b6000600c819055600380549190556117bc33826120fc565b60405181815233907f5d3b8fa9823b18b176cfe79e002a5b931b8569313802f700eb8550bc6a353246906020016107fe565b6118196040518060800160405280600081526020016000815260200160008152602001600081525090565b506001600160a01b0316600090815260086020908152604091829020825160808101845281548152600182015492810192909252600281015492820192909252600390910154606082015290565b60025461010090046001600160a01b031633146118bf5760405162461bcd60e51b815260206004820152601660248201527513db9b1e481d985b1a59185d1bdc88185b1b1bddd95960521b60448201526064016106c9565b600554600a6118d16127106003612359565b6118db9190612337565b81111561191c5760405162461bcd60e51b815260206004820152600f60248201526e125b9d985b1a59081c195c98d95b9d608a1b60448201526064016106c9565b6006541580159061193a57506006546014906119389043612378565b115b6119865760405162461bcd60e51b815260206004820152601860248201527f496e74657276616c206e6f74206c6f6e6720656e6f756768000000000000000060448201526064016106c9565b600580546004819055600091829055600682905560405190917f450a792501c47863e89114cbdd0497acb22d4abfc51dc315afc323c5ba92d4a991a250565b3361c00314611a165760405162461bcd60e51b815260206004820152601460248201527f50756e69736820636f6e7472616374206f6e6c7900000000000000000000000060448201526064016106c9565b61c0026001600160a01b031663c885bc586040518163ffffffff1660e01b8152600401600060405180830381600087803b158015611a5357600080fd5b505af1158015611a67573d6000803e3d6000fd5b505050506000670de0b6b3a764000060075410611a8c57670de0b6b3a7640000611a90565b6007545b905080600754611aa09190612378565b600755801561127857611ab46000826120fc565b6002546040518281526101009091046001600160a01b0316907f0a3c8b346f3f7fe5668c9f575473491c4274339e10c9548d7995f22211f988f09060200161126f565b60026001541415611b4a5760405162461bcd60e51b815260206004820152601f60248201527f5265656e7472616e637947756172643a207265656e7472616e742063616c6c0060448201526064016106c9565b600260018190555061c0026001600160a01b031663c885bc586040518163ffffffff1660e01b8152600401600060405180830381600087803b158015611b8f57600080fd5b505af1158015611ba3573d6000803e3d6000fd5b505033600090815260086020526040812060018101549054600954929450909250670de0b6b3a764000091611bd89190612359565b611be29190612337565b611bec9190612378565b90503415611d155733600090815260086020526040902054611c0f90349061231f565b336000908152600860205260409020819055600954670de0b6b3a764000091611c389190612359565b611c429190612337565b33600090815260086020526040902060010155600a54611c6390349061231f565b600a5560405134815233907fe1fffcc4923d04b559f4d29a8bfc6cda04eb5b0d3c460751c2402c5c5cc9109c9060200160405180910390a2600160025460ff166003811115611cb457611cb46123a5565b1415611d105761c0026001600160a01b031663136ec0b36040518163ffffffff1660e01b8152600401600060405180830381600087803b158015611cf757600080fd5b505af1158015611d0b573d6000803e3d6000fd5b505050505b611d59565b60095433600090815260086020526040902054670de0b6b3a764000091611d3b91612359565b611d459190612337565b336000908152600860205260409020600101555b8015611d9b57611d6933826120fc565b60405181815233907f7cddc560d4de1ea9d83e4123f01e6072afc503bb47bcc765f0396ba3861a0454906020016107fe565b5060018055565b60025461010090046001600160a01b03163314611dfa5760405162461bcd60e51b815260206004820152601660248201527513db9b1e481d985b1a59185d1bdc88185b1b1bddd95960521b60448201526064016106c9565b600160025460ff166003811115611e1357611e136123a5565b1480611e225750611e2261221a565b611e605760405162461bcd60e51b815260206004820152600f60248201526e496e636f727265637420737461746560881b60448201526064016106c9565b43600c55600060025460ff166003811115611e7d57611e7d6123a5565b14611f0d576002805460ff1916905560006040517f402ee26d4c255fcb07b0b7b5b93b77377832260977c25be44f3c8feffd2df70e90600090a261c0026001600160a01b03166371df76786040518163ffffffff1660e01b8152600401600060405180830381600087803b158015611ef457600080fd5b505af1158015611f08573d6000803e3d6000fd5b505050505b6002546040516101009091046001600160a01b0316907f7c79e6e24ed041d1072d54523b53956f01b91b835f0490856370594d9d14470e90600090a2565b60025461010090046001600160a01b03163314611fa35760405162461bcd60e51b815260206004820152601660248201527513db9b1e481d985b1a59185d1bdc88185b1b1bddd95960521b60448201526064016106c9565b80600a611fb36127106003612359565b611fbd9190612337565b811115611ffe5760405162461bcd60e51b815260206004820152600f60248201526e125b9d985b1a59081c195c98d95b9d608a1b60448201526064016106c9565b60058290554360065560405182907f2dcbffddb492dea86de0b18dac6d71f51a7b7a5ec946512e0c993a050f3b48ea90600090a25050565b3361c002146120875760405162461bcd60e51b815260206004820152601860248201527f56616c696461746f727320636f6e7472616374206f6e6c79000000000000000060448201526064016106c9565b60006127106004543461209a9190612359565b6120a49190612337565b9050806007546120b4919061231f565b600755600a541561127857600954600a54670de0b6b3a76400006120d88434612378565b6120e29190612359565b6120ec9190612337565b6120f6919061231f565b60095550565b8047101561214c5760405162461bcd60e51b815260206004820152601d60248201527f416464726573733a20696e73756666696369656e742062616c616e636500000060448201526064016106c9565b6000826001600160a01b03168260405160006040518083038185875af1925050503d8060008114612199576040519150601f19603f3d011682016040523d82523d6000602084013e61219e565b606091505b50509050806122155760405162461bcd60e51b815260206004820152603a60248201527f416464726573733a20756e61626c6520746f2073656e642076616c75652c207260448201527f6563697069656e74206d6179206861766520726576657274656400000000000060648201526084016106c9565b505050565b60008060025460ff166003811115612234576122346123a5565b148061226e5750600360025460ff166003811115612254576122546123a5565b14801561226e5750600a600b544361226c9190612378565b115b905090565b60006020828403121561228557600080fd5b81356001600160a01b038116811461229c57600080fd5b9392505050565b6000602082840312156122b557600080fd5b8135801515811461229c57600080fd5b6000602082840312156122d757600080fd5b5035919050565b6000602082840312156122f057600080fd5b5051919050565b602081016004831061231957634e487b7160e01b600052602160045260246000fd5b91905290565b600082198211156123325761233261238f565b500190565b60008261235457634e487b7160e01b600052601260045260246000fd5b500490565b60008160001904831182151516156123735761237361238f565b500290565b60008282101561238a5761238a61238f565b500390565b634e487b7160e01b600052601160045260246000fd5b634e487b7160e01b600052602160045260246000fdfea164736f6c6343000807000aa164736f6c6343000807000a"
)

type hardForkValidatorsV1 struct {
}

func (s *hardForkValidatorsV1) GetName() string {
	return DposFactoryContractName
}

func (s *hardForkValidatorsV1) Update(config *params.ChainConfig, height *big.Int, state *state.StateDB) (err error) {
	contractCode := common.FromHex(validatorV1Code)

	//write code to sys contract
	state.SetCode(DposFactoryContractAddr, contractCode)
	log.Debug("Write code to system contract account", "addr", DposFactoryContractAddr.String(), "code", validatorV1Code)

	return
}

func (s *hardForkValidatorsV1) getAdminByChainId(chainId *big.Int) common.Address {
	if chainId.Cmp(params.MainnetChainConfig.ChainID) == 0 {
		return validatorV1Admin
	}

	return validatorV1AdminTestnet
}

func (s *hardForkValidatorsV1) Execute(state *state.StateDB, header *types.Header, chainContext core.ChainContext, config *params.ChainConfig) (err error) {
	return nil
	/*
		//First, get top validators from the old contract
		v0 := NewValidatorV0()
		topVals, err := v0.GetTopValidators(state, header, chainContext, config)
		if err != nil {
			log.Error("getTopValidators from V0 failed", "err", err)
			return err
		}
		managers := make([]common.Address, 0, len(topVals))
		for _, val := range topVals {
			feeAddr, err := v0.GetValidatorFeeAddr(val, state, header, chainContext, config)
			if err != nil {
				return err
			}
			managers = append(managers, feeAddr)
		}

		// initialize v1 contract
		method := "initialize"
		//fmt.Println(topVals,managers)

		data, err := GetInteractiveABI()[DposFactoryContractName].Pack(method, topVals, managers, s.getAdminByChainId(config.ChainID))
		//fmt.Println(data)
		if err != nil {
			log.Error("Can't pack data for initialize", "error", err)
			return err
		}

		msg := types.NewMessage(header.Coinbase, &DposFactoryContractAddr, 0, new(big.Int), math.MaxUint64, new(big.Int), data, nil, false)
		_, err = vmcaller.ExecuteMsg(msg, state, header, chainContext, config)

		return*/

}
